<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dead Code Elimination â€¢ rco</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dead Code Elimination">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rco</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Optimizers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/opt-common-subexpr.html">Common Subexpression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-constant-folding.html">Constant Folding</a>
    </li>
    <li>
      <a href="../articles/opt-constant-propagation.html">Constant Propagation</a>
    </li>
    <li>
      <a href="../articles/opt-dead-code.html">Dead Code Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-expr.html">Dead Expression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-store.html">Dead Store Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-loop-invariant.html">Loop-invariant Code Motion</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contributing-an-optimizer.html">Contributing an Optimizer</a>
    </li>
    <li>
      <a href="../articles/docker-readme.html">Docker Image</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Dead Code Elimination</h1>
            
      
      
      <div class="hidden name"><code>opt-dead-code.Rmd</code></div>

    </div>

    
    
<div id="dead-code-elimination" class="section level1">
<h1 class="hasAnchor">
<a href="#dead-code-elimination" class="anchor"></a>Dead Code Elimination</h1>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Dead Code Elimination is an optimization that removes code which does not affect the program results. You might wonder why someone would write this type of source code, but it can easily creep into large, long-lived programs even at the source code level. Removing such code has several benefits: it shrinks program size and it allows the running program to avoid executing irrelevant operations, which reduces its running time. It can also enable further optimizations by simplifying program structure.</p>
<p>For example, consider the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">foo &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  a &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="cf">if</span> (a <span class="op">&gt;</span><span class="st"> </span><span class="dv">25</span>) {</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    a &lt;-<span class="st"> </span><span class="dv">25</span> <span class="co"># dead code</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  }</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(a)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  b &lt;-<span class="st"> </span><span class="dv">24</span> <span class="co"># dead code</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(b) <span class="co"># dead code</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">}</a></code></pre></div>
<p>In functions, after calling <code>return</code>, the following code would not be executed, so it is dead code and can be eliminated. In this example, resulting in:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">foo &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  a &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="cf">if</span> (a <span class="op">&gt;</span><span class="st"> </span><span class="dv">25</span>) {</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  }</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(a)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">}</a></code></pre></div>
<p>Also, after constant <a href="opt-constant-propagation.html">propagating</a> and <a href="opt-constant-folding.html">folding</a> we would get:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">foo &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  a &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="cf">if</span> (<span class="ot">FALSE</span>) { <span class="co"># dead code</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="dv">25</span>) <span class="co"># dead code</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  } <span class="co"># dead code</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(a)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">}</a></code></pre></div>
<p>So it could be reduced to:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">foo &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  a &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(a)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">}</a></code></pre></div>
<p>This dead code optimizer also removes code after <code>next</code> or <code>break</code> calls.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Consider the following example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">code &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="st">"i &lt;- 0"</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="st">"n &lt;- 1000"</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="st">"while (i &lt; n) {"</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="st">"  if (TRUE) {"</span>,</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="st">"    i &lt;- i + 1"</span>,</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  <span class="st">"  } else {"</span>,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  <span class="st">"    i &lt;- i - 1"</span>,</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="st">"  }"</span>,</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  <span class="st">"}"</span>,</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(code)</a></code></pre></div>
<pre><code>## i &lt;- 0
## n &lt;- 1000
## while (i &lt; n) {
##   if (TRUE) {
##     i &lt;- i + 1
##   } else {
##     i &lt;- i - 1
##   }
## }</code></pre>
<p>Then, the automatically optimized code would be:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">opt_code &lt;-<span class="st"> </span><span class="kw"><a href="../reference/opt_dead_code.html">opt_dead_code</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(code))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(opt_code<span class="op">$</span>codes[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## i &lt;- 0
## n &lt;- 1000
## while (i &lt; n) {
##   i &lt;- i + 1
## }</code></pre>
<p>And if we measure the execution time of each one, and the speed-up:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">bmark_res &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>({</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="dt">text =</span> code))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">}, {</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="kw"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="dt">text =</span> opt_code))</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">})</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw">autoplot</span>(bmark_res)</a></code></pre></div>
<p><img src="opt-dead-code_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">speed_up</span>(bmark_res)</a></code></pre></div>
<pre><code>##            Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
## Expr_2 73.43063 72.14767 50.80005 60.56871 47.81691 186.6154</code></pre>
</div>
<div id="implementation" class="section level2">
<h2 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h2>
<p>The <code>opt_dead_code</code> optimizer performs two main tasks:</p>
<div id="remove-code-after-interruption-commands" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-code-after-interruption-commands" class="anchor"></a>Remove code after interruption commands</h3>
<p>All the code, that is equally-nested, found after a <code>break</code>, <code>next</code>, or <code>return</code> call is removed. Something important to note is that it assumes that <strong>the <code>return</code> function has not been overwritten</strong>.</p>
</div>
<div id="remove-constant-conditionals" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-constant-conditionals" class="anchor"></a>Remove constant conditionals</h3>
<p>This task has sub-items:</p>
<ul>
<li><p>Remove <code>FALSE</code> whiles: <code>while (FALSE) { expr }</code> expressions are removed from the code.</p></li>
<li><p>Remove <code>FALSE</code> ifs: <code>if (FALSE) { expr }</code> expressions are removed. And <code>if (FALSE) { expr1 } else { expr2 }</code> is replaced by <code>expr2</code>.</p></li>
<li><p>Replace <code>TRUE</code> ifs: <code>if (TRUE) { expr }</code> is replaced by <code>expr</code>. And <code>if (TRUE) { expr1 } else { expr2 }</code> is replaced by <code>expr1</code>.</p></li>
</ul>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#dead-code-elimination">Dead Code Elimination</a><ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#example">Example</a></li>
      <li><a href="#implementation">Implementation</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Juan Cruz Rodriguez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
