<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Constant Propagation • rco</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Constant Propagation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rco</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Optimizers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/opt-common-subexpr.html">Common Subexpression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-constant-folding.html">Constant Folding</a>
    </li>
    <li>
      <a href="../articles/opt-constant-propagation.html">Constant Propagation</a>
    </li>
    <li>
      <a href="../articles/opt-dead-code.html">Dead Code Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-expr.html">Dead Expression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-store.html">Dead Store Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-loop-invariant.html">Loop-invariant Code Motion</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contributing-an-optimizer.html">Contributing an Optimizer</a>
    </li>
    <li>
      <a href="../articles/docker-readme.html">Docker Image</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jcrodriguez1989/rco">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Constant Propagation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jcrodriguez1989/rco/blob/master/vignettes/opt-constant-propagation.Rmd"><code>vignettes/opt-constant-propagation.Rmd</code></a></small>
      <div class="hidden name"><code>opt-constant-propagation.Rmd</code></div>

    </div>

    
    
<div id="constant-propagation" class="section level1">
<h1 class="hasAnchor">
<a href="#constant-propagation" class="anchor"></a>Constant Propagation</h1>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Constant propagation is the process of substituting the values of known constants in expressions. Constant propagation eliminates cases in which values are copied from one location or variable to another, in order to simply assign their value to another variable.</p>
<p>For example, consider the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">7</span> <span class="op">-</span><span class="st"> </span>x <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">z &lt;-<span class="st"> </span>y <span class="op">*</span><span class="st"> </span>(<span class="dv">28</span> <span class="op">/</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>x</a></code></pre></div>
<p>Here, <code>x</code> is assigned a constant, and thus, can be propagated (three times). Propagating yields:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">7</span> <span class="op">-</span><span class="st"> </span><span class="dv">14</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">z &lt;-<span class="st"> </span>y <span class="op">*</span><span class="st"> </span>(<span class="dv">28</span> <span class="op">/</span><span class="st"> </span><span class="dv">14</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="dv">14</span></a></code></pre></div>
<p>Constant propagation enables the code to assign static values, which is faster than looking up and copying the value of a variable, and also saves time by eliminating assigning a value to a variable that is itself subsequently used only to propagate that value throughout the code. In some cases, copy propagation itself may not provide direct optimizations, but simply facilitates other transformations, such as <a href="opt-constant-folding.html">constant folding</a>, code motion, and <a href="opt-dead-code.html">dead code elimination</a>.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>A simple example would be a code that converts the unit of many temporary samples, from hours to miliseconds <code>miliseconds &lt;- 1000 * 60 * 60 * hours</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">code &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="st">"n &lt;- 1000"</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="st">"hours_vector &lt;- runif(n, 0, 24)"</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="st">"ms_vector &lt;- numeric(n)"</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="st">"hs_to_mins &lt;- 60"</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="st">"mins_to_secs &lt;- 60"</span>,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="st">"secs_to_ms &lt;- 1000"</span>,</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="st">"# of course it would be much efficient to do vectorized operations xP"</span>,</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="st">"for (i in 1:n) {"</span>,</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  <span class="st">"  ms_vector[i] &lt;- secs_to_ms * mins_to_secs * hs_to_mins * hours_vector[i]"</span>,</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  <span class="st">"}"</span>,</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(code)</a></code></pre></div>
<pre><code>## n &lt;- 1000
## hours_vector &lt;- runif(n, 0, 24)
## ms_vector &lt;- numeric(n)
## hs_to_mins &lt;- 60
## mins_to_secs &lt;- 60
## secs_to_ms &lt;- 1000
## # of course it would be much efficient to do vectorized operations xP
## for (i in 1:n) {
##   ms_vector[i] &lt;- secs_to_ms * mins_to_secs * hs_to_mins * hours_vector[i]
## }</code></pre>
<p>Then, the automatically optimized code would be:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">opt_code &lt;-<span class="st"> </span><span class="kw"><a href="../reference/opt_constant_propagation.html">opt_constant_propagation</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(code))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(opt_code<span class="op">$</span>codes[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## n &lt;- 1000
## hours_vector &lt;- runif(n, 0, 24)
## ms_vector &lt;- numeric(n)
## hs_to_mins &lt;- 60
## mins_to_secs &lt;- 60
## secs_to_ms &lt;- 1000
## # of course it would be much efficient to do vectorized operations xP
## for (i in 1:n) {
##   ms_vector[i] &lt;- 1000 * 60 * 60 * hours_vector[i]
## }</code></pre>
<p>And if we measure the execution time of each one, and the speed-up:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">bmark_res &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>({</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/eval">eval</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/parse">parse</a></span>(<span class="dt">text =</span> code))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">}, {</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/eval">eval</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/parse">parse</a></span>(<span class="dt">text =</span> opt_code))</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">})</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw">autoplot</span>(bmark_res)</a></code></pre></div>
<p><img src="opt-constant-propagation_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">speed_up</span>(bmark_res)</a></code></pre></div>
<pre><code>##            Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
## Expr_2 28.44638 28.71861 25.56709 29.57331 27.04842 73.10419</code></pre>
</div>
<div id="implementation" class="section level2">
<h2 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h2>
<p>The <code>opt_constant_propagation</code> optimizer analyzes the code from top to bottom. As it goes through the code, it performs two tasks:</p>
<ul>
<li><p>Saves, in the <code>values</code> vector, those variables that are assigned a constant value. I.e., if <code>x &lt;- -3</code>, then <code>values$x &lt;- -3</code>.</p></li>
<li><p>Each variable that is assigned an expression that includes a variable present in <code>values</code> is given the corresponding constant value. I.e., <code>y &lt;- 7 * x + z</code> is transformed to <code>y &lt;- 7 * -3 + z</code>.</p></li>
</ul>
<p>Depending on what expression it finds, it applies one of the following criteria:</p>
<div id="var---const" class="section level3">
<h3 class="hasAnchor">
<a href="#var---const" class="anchor"></a><code>VAR &lt;- CONST</code>
</h3>
<p>If it is an assignment of a constant value: then it keeps the same expression, and saves <code>VAR = CONST</code> in <code>values</code>.</p>
<p>This criteria also includes, multi-assign ( <code>VAR &lt;- VAR &lt;- CONST</code> ).</p>
</div>
<div id="var-const-var" class="section level3">
<h3 class="hasAnchor">
<a href="#var-const-var" class="anchor"></a><code>VAR * CONST + VAR</code>
</h3>
<p>If it is only operators, variables, constants, and precedence operators: then it will check if any of the variables is stored in <code>values</code> vector, and would replace them in the expression. It will return the modified expression.</p>
</div>
<div id="funfun_params" class="section level3">
<h3 class="hasAnchor">
<a href="#funfun_params" class="anchor"></a><code>FUN({FUN_PARAMS})</code>
</h3>
<p>If it is a function call, and <code>opt_constant_propagation</code>’s <code>in_fun_call</code> parameter is set to <code>TRUE</code>: then it will try to constant propagate in <code>{FUN_PARAMS}</code>. Consider the case that the function call is <code><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len(x+30)</a></code>, it could be replaced by <code><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len(-3+30)</a></code>.</p>
<p>Then, <strong>it empties the <code>values</code> vector</strong> ( <code>values &lt;- c()</code> ). It should be noted that in R, calling a function can modify the current environment, being the simplest example <code><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm(list = ls())</a></code>, or <code><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign("x", 4)</a></code>.</p>
</div>
<div id="loop-cond-body" class="section level3">
<h3 class="hasAnchor">
<a href="#loop-cond-body" class="anchor"></a><code>LOOP (COND) { BODY }</code>
</h3>
<p>If it is a loop ( <code>repeat</code>, <code>while</code>, or <code>for</code> ): it will get which variables are being assigned in the loop and remove them from <code>values</code>, and then propagate in <code>COND</code> and <code>BODY</code>.</p>
<p>In-loop assigned variables are removed from <code>values</code> as, if not, it would try to propagate them, and these variables might change in next execution of <code>BODY</code>. For instance:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="cf">while</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  y &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  x &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">}</a></code></pre></div>
<p>Would try to propagate to:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="cf">while</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  y &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  x &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">}</a></code></pre></div>
<p>which is not equivalent.</p>
</div>
<div id="if-cond-body-else-body" class="section level3">
<h3 class="hasAnchor">
<a href="#if-cond-body-else-body" class="anchor"></a><code>IF (COND) { BODY } ELSE { BODY }</code>
</h3>
<p>If it is an <code>if</code>: it will propagate <code>values</code> in <code>COND</code> and <code>BODY</code>, then it will get which variables are being assigned in the if/else <code>BODY</code> and remove them from <code>values</code>.</p>
<p>In-loop assigned variables are removed from <code>values</code>, as it is possible that the <code>BODY</code> is never executed (<code>FALSE</code> condition), and thus, these variables would not be updated or assigned.</p>
</div>
<div id="var---expr" class="section level3">
<h3 class="hasAnchor">
<a href="#var---expr" class="anchor"></a><code>VAR &lt;- EXPR</code>
</h3>
<p>If it is an assignment (of a non constant value): it will keep <code>VAR &lt;-</code> and try to propagate on <code>EXPR</code>. Moreover, it will remove <code>VAR</code> from <code>values</code> as it is assigned a non-constant value.</p>
</div>
<div id="fun-fun_params-body" class="section level3">
<h3 class="hasAnchor">
<a href="#fun-fun_params-body" class="anchor"></a><code>FUN ({FUN_PARAMS}) { BODY }</code>
</h3>
<p>If it is a function definition: it will propagate on the <code>BODY</code> but with a new empty <code>values</code> vector (the global <code>values</code> vector would not be changed). Note that in R, a function definition will have another environment, and thus it should not use the current <code>values</code>.</p>
</div>
<div id="other-cases" class="section level3">
<h3 class="hasAnchor">
<a href="#other-cases" class="anchor"></a>Other cases</h3>
<p>In any other case, it should keep propagating on sub-expressions.</p>
</div>
</div>
<div id="to-do" class="section level2">
<h2 class="hasAnchor">
<a href="#to-do" class="anchor"></a>To-Do</h2>
<ul>
<li>
<p>Recognize functions that modify the environment?</p>
<p>When <code>opt_constant_propagation</code> finds a function call, it deletes the previously found constant-assigned values. This is mainly done to avoid having</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="st">"x"</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">y &lt;-<span class="st"> </span>x</a></code></pre></div>
<p>Propagated to</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="st">"x"</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="dv">1</span></a></code></pre></div>
<p>In R we can list which <code>base</code> functions modify the environment, for example, <code>assign</code>, <code>rm</code>, etc. However, this would not be a solution, as we can define new functions that wrap the <code>base</code> ones, for instance:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">rm_all &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">env &lt;-<span class="st"> </span>.GlobalEnv</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ls">ls</a></span>(<span class="dt">envir =</span> env), <span class="dt">envir =</span> env)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">}</a></code></pre></div>
<p>A possible solution would be to let the user identify which functions edit the environment.</p>
<ul>
<li>
<p>in a <code>roxygen2</code> way:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># o @edits_env rm_all</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">...</a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">rm_all</span>() <span class="co"># o @edits_env</span></a></code></pre></div>
</li>
<li>
<p>by parameter:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/opt_constant_propagation.html">opt_constant_propagation</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(code), <span class="dt">env_edit =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"rm_all"</span>, ...))</a></code></pre></div>
</li>
</ul>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#constant-propagation">Constant Propagation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#example">Example</a></li>
      <li><a href="#implementation">Implementation</a></li>
      <li><a href="#to-do">To-Do</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Juan Cruz Rodriguez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
